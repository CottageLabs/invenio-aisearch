{#
  Copyright (C) 2025 Cottage Labs.

  invenio-aisearch is free software; you can redistribute it and/or modify it
  under the terms of the MIT License; see LICENSE file for more details.
#}

{%- extends config.INVENIO_AISEARCH_BASE_TEMPLATE %}

{%- block page_body %}
<div class="ui container" style="margin-top: 2em;">
  <h1 class="ui header">
    <i class="file alternate outline icon"></i>
    <div class="content">
      Passage Search
      <div class="sub header">Find specific passages within documents using natural language</div>
    </div>
  </h1>

  <div class="ui info message">
    <i class="info circle icon"></i>
    <div class="content">
      <p>
        This searches through 28,877 passages from 89 books to find semantically relevant text snippets.
        Try queries like:
      </p>
      <ul class="list">
        <li>"protagonist makes an important decision"</li>
        <li>"main character embarks on their quest"</li>
        <li>"moments of sacrifice and selflessness"</li>
        <li>"philosophical reflections on death and mortality"</li>
      </ul>
    </div>
  </div>

  <div class="ui segment">
    <form class="ui form" id="passage-search-form">
      <div class="field">
        <label>Query</label>
        <div class="ui action input">
          <input
            type="text"
            id="passage-query"
            name="query"
            placeholder="Describe the passage you're looking for..."
            autocomplete="off"
          >
          <button class="ui primary button" type="submit">
            <i class="search icon"></i>
            Search Passages
          </button>
        </div>
      </div>

      <div class="field">
        <label>Results limit</label>
        <input
          type="number"
          id="passage-limit"
          name="limit"
          value="10"
          min="1"
          max="50"
          style="width: 100px;"
        >
      </div>
    </form>
  </div>

  <div id="passage-results-container" style="display: none;">
    <div class="ui segment">
      <div id="passage-meta" class="ui horizontal list">
        <div class="item">
          <div class="content">
            <div class="header" id="passage-results-count">0 results</div>
          </div>
        </div>
        <div class="item">
          <div class="content">
            <div class="ui text" id="passage-query-info"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="ui relaxed divided items" id="passage-results">
      <!-- Results will be inserted here -->
    </div>
  </div>

  <div id="passage-loading" style="display: none;" class="ui segment">
    <div class="ui active inverted dimmer">
      <div class="ui text loader">Searching passages...</div>
    </div>
    <p style="visibility: hidden;">Loading placeholder</p>
  </div>

  <div id="passage-error" style="display: none;" class="ui negative message">
    <i class="close icon"></i>
    <div class="header">Search Error</div>
    <p id="passage-error-text"></p>
  </div>

  <div id="passage-no-results" style="display: none;" class="ui icon message">
    <i class="search icon"></i>
    <div class="content">
      <div class="header">No passages found</div>
      <p>Try a different query or adjust your search terms.</p>
    </div>
  </div>
</div>
{%- endblock page_body %}

{%- block javascript %}
{{ super() }}
{{ webpack['invenio-aisearch-passages.js'] }}
{%- endblock javascript %}
